{% extends 'base.html' %}

{% block title %}Compare Tyre Sizes - TyreMaster{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">
        <i class="fas fa-exchange-alt text-primary"></i> Compare Tyre Sizes
    </h1>
    
    <div class="row">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">Tyre 1</h5>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-4">
                            <label>Width</label>
                            <input type="number" class="form-control tyre1-width" value="195">
                        </div>
                        <div class="col-4">
                            <label>Aspect Ratio</label>
                            <input type="number" class="form-control tyre1-ratio" value="65">
                        </div>
                        <div class="col-4">
                            <label>Rim</label>
                            <input type="number" class="form-control tyre1-rim" value="15">
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-6">
            <div class="card">
                <div class="card-header bg-success text-white">
                    <h5 class="mb-0">Tyre 2</h5>
                </div>
                <div class="card-body">
                    <div class="row mb-3">
                        <div class="col-4">
                            <label>Width</label>
                            <input type="number" class="form-control tyre2-width" value="205">
                        </div>
                        <div class="col-4">
                            <label>Aspect Ratio</label>
                            <input type="number" class="form-control tyre2-ratio" value="55">
                        </div>
                        <div class="col-4">
                            <label>Rim</label>
                            <input type="number" class="form-control tyre2-rim" value="16">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="text-center my-4">
        <button class="btn btn-lg btn-warning" onclick="compareTyres()">
            <i class="fas fa-balance-scale"></i> Compare Now
        </button>
    </div>
    
    <div id="comparisonResults" class="card">
        <div class="card-body">
            <p class="text-center text-muted">Comparison results will appear here</p>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
function compareTyres() {
    // Get values
    const t1 = {
        w: parseInt(document.querySelector('.tyre1-width').value),
        r: parseInt(document.querySelector('.tyre1-ratio').value),
        d: parseInt(document.querySelector('.tyre1-rim').value)
    };
    
    const t2 = {
        w: parseInt(document.querySelector('.tyre2-width').value),
        r: parseInt(document.querySelector('.tyre2-ratio').value),
        d: parseInt(document.querySelector('.tyre2-rim').value)
    };
    
    // Calculations
    const t1Sidewall = t1.w * (t1.r / 100);
    const t2Sidewall = t2.w * (t2.r / 100);
    
    const t1Diameter = (t1.d * 25.4) + (2 * t1Sidewall);
    const t2Diameter = (t2.d * 25.4) + (2 * t2Sidewall);
    
    const diameterDiff = ((t2Diameter - t1Diameter) / t1Diameter) * 100;
    const speedoError = diameterDiff;
    
    const t1Circumference = Math.PI * t1Diameter;
    const t2Circumference = Math.PI * t2Diameter;
    
    // Display results
    document.getElementById('comparisonResults').innerHTML = `
        <div class="card-body">
            <h4 class="text-center mb-4">Comparison Results</h4>
            
            <div class="row">
                <div class="col-md-6 text-center">
                    <h3 class="text-primary">${t1.w}/${t1.r}R${t1.d}</h3>
                    <p>Diameter: ${t1Diameter.toFixed(1)} mm</p>
                    <p>Circumference: ${t1Circumference.toFixed(1)} mm</p>
                </div>
                <div class="col-md-6 text-center">
                    <h3 class="text-success">${t2.w}/${t2.r}R${t2.d}</h3>
                    <p>Diameter: ${t2Diameter.toFixed(1)} mm</p>
                    <p>Circumference: ${t2Circumference.toFixed(1)} mm</p>
                </div>
            </div>
            
            <hr>
            
            <div class="alert ${Math.abs(speedoError) > 3 ? 'alert-warning' : 'alert-info'}">
                <h5><i class="fas fa-tachometer-alt"></i> Speedometer Impact</h5>
                <p>
                    When switching from Tyre 1 to Tyre 2:
                    ${speedoError > 0 ? 
                        `Your speedometer will read <strong>${speedoError.toFixed(1)}% SLOWER</strong> than actual speed.` : 
                        `Your speedometer will read <strong>${Math.abs(speedoError).toFixed(1)}% FASTER</strong> than actual speed.`}
                </p>
                <p>
                    <strong>Example:</strong> If your speedometer shows 100 km/h, 
                    your actual speed would be ${(100 * (1 + (speedoError/100))).toFixed(1)} km/h.
                </p>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body">
                            <h6>Recommendation</h6>
                            ${Math.abs(speedoError) <= 3 ? 
                                '<p class="text-success"><i class="fas fa-check-circle"></i> Size change is within safe limits (Â±3%)</p>' :
                                '<p class="text-danger"><i class="fas fa-exclamation-triangle"></i> Size change exceeds recommended limits</p>'}
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-body">
                            <h6>Visual Difference</h6>
                            <div class="progress" style="height: 20px;">
                                <div class="progress-bar" style="width: ${50 + (speedoError/2)}%">
                                    ${speedoError.toFixed(1)}% difference
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;
}
</script>
{% endblock %}